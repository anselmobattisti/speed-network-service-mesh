---
apiVersion: v1
kind: Pod
metadata:
  name: alpine
  labels:
    app: alpine
  annotations:
    networkservicemesh.io: kernel://interdomain-nse-composition@my.cluster3/nsm-1
spec:
  containers:
  - name: alpine
    image: alpine:3.22.2
    imagePullPolicy: IfNotPresent
    # simple `sleep` command would work
    # but we need `trap` to be able to delete pods quckly
    command:
      - /bin/sh
      - -c
      - |
        apk add --no-cache iperf3 && \
        trap : TERM INT; sleep infinity & wait